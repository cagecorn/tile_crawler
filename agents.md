# 에이전트 (Agents) 행동 설계

이 문서는 게임에 등장하는 모든 자율적 행동 주체(플레이어, 용병, 몬스터 등)의 인공지능(AI) 시스템 구조를 정의합니다.

## 1. AI 아키텍처 개요

본 게임의 AI는 **계층형 구조**를 가집니다. 이는 각 유닛이 단순히 주변 상황에만 반응하는 것을 넘어, 소속된 '그룹'의 '전략'과 자신에게 주어진 '역할', 그리고 고유의 '성격'에 따라 입체적으로 행동하게 만들기 위함입니다.

## 2. 핵심 개념

### 2.1. 그룹 (Group)
모든 유닛은 특정 '그룹'에 소속됩니다.
* **`player_party`**: 플레이어와 모든 아군 용병이 속한 그룹입니다.
* **`dungeon_monsters`**: 해당 층의 모든 몬스터가 속한 그룹입니다.
* **기타**: '보스와 부하들'처럼 특정 이벤트에 따라 새로운 그룹이 생성될 수 있습니다.

### 2.2. 전략 (Strategy)
각 그룹은 `MetaAIManager`에 의해 상위 '전략'을 할당받습니다. 이 전략은 그룹 전체의 행동 방향을 결정합니다.
* **`AGGRESSIVE` (공격적):** 시야 내의 적을 적극적으로 찾아 공격합니다. (현재 구현된 기본 전략)
* **`DEFENSIVE` (방어적):** 특정 지점이나 대상을 호위하며, 자신의 영역에 들어온 적에게만 반응합니다. (미래 구현)
* **`FLEE` (도망):** 전력이 불리할 때, 적에게서 도망칩니다. (미래 구현)

### 2.3. AI 유형 (AI Archetype)
각 유닛은 자신의 '직업'이나 '종족'에 맞는 기본 행동 패턴, 즉 'AI 유형'을 가집니다.
* **`MeleeAI` (전사형):** 적에게 근접하여 싸웁니다.
* **`RangedAI` (원거리형):** 적과 거리를 유지하며 싸웁니다. (카이팅)
* **`HealerAI` (힐러형):** 아군의 생존을 최우선으로 생각하며, 회복 스킬을 우선적으로 사용합니다.
* **`BufferAI` (버퍼형):** 아군에게 이로운 효과를 부여하는 것을 우선으로 합니다.

*중요: 유닛의 AI 유형은 장착한 무기의 `태그`에 따라 동적으로 변경될 수 있습니다. (예: 활을 장착한 전사는 `RangedAI`를 갖게 됨)*

### 2.4. 성격 (MBTI - 미래 구현)
각 유닛은 생성될 때 고유한 '성격'을 부여받습니다. 이 성격은 AI 유형의 행동 방식을 미세하게 조정합니다.
* **E/I:** 스킬/도구 사용 시, 아군을 우선할 것인가(E) 자신을 우선할 것인가(I).
* **S/N:** 스킬/도구를 즉시 사용할 것인가(S) 아꼈다가 결정적인 순간에 사용할 것인가(N).
* **T/F:** 가장 약한 적을 노릴 것인가(T) 다른 아군과 협공할 것인가(F).
* **P/J:** 저돌적으로 돌격할 것인가(P) 신중하게 거리를 유지할 것인가(J).

## 3. 최종 행동 결정 흐름

한 유닛이 최종 행동을 결정하기까지의 과정은 다음과 같습니다.

1.  **전략 확인:** 내가 속한 그룹의 현재 '전략'은 무엇인가? (예: `AGGRESSIVE`)
2.  **상황 분석:** 내 주변에 아군과 적은 누구누구 있는가? 나의 현재 HP는?
3.  **AI 유형 판단:** 나의 'AI 유형'은 무엇인가? (예: `HealerAI`)
4.  **성격 반영:** 나의 '성격'은 무엇인가? (예: `E`, `N`)
5.  **최종 행동 결정:**
    * (전략: 공격적, AI: 힐러, 성격: E, N) -> "시야 내 아군의 HP가 30% 이하로 떨어졌다. 위험한 순간(N)이므로, 가장 HP가 낮은 아군(E)에게 '치유' 스킬을 사용해야겠다."

---
*이 문서는 새로운 AI 기능이 추가될 때마다 지속적으로 업데이트되어야 합니다.*

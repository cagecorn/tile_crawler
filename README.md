# 타일 크롤러 (Tile Crawler)

이 프로젝트는 캔버스 렌더링 기반의 실시간 던전 크롤러 게임입니다. 플레이어는 절차적으로 생성되는 던전을 탐험하고, 동료를 고용하며, 아이템을 파밍하고, 다양한 몬스터와 싸우며 성장합니다.

## 핵심 특징

* **실시간 전투:** 턴제가 아닌, 모든 유닛이 실시간으로 판단하고 행동하는 액션 기반의 전투 시스템을 가집니다.
* **절차적 던전 생성:** 게임을 시작할 때마다 '방과 미로' 알고리즘을 통해 항상 새로운 구조의 던전이 생성됩니다.
* **계층형 AI 시스템:** 모든 유닛은 'AI 유형(Archetype)'에 따라 행동하며, '그룹' 단위로 '메타 전략'을 부여받아 유기적으로 움직입니다.
* **데이터 기반 설계:** 아이템, 스킬, 직업 등 대부분의 게임 콘텐츠가 코드와 분리된 데이터 파일로 관리되어 확장과 밸런스 조정이 용이합니다.
* **모듈식 관리자 시스템:** 게임의 각 기능(맵, 몬스터, UI, 이벤트 등)은 독립된 '매니저'가 전담하여, 시스템의 안정성과 유지보수성을 높입니다.

## 개발 원칙

* **단일 책임 원칙:** 모든 파일과 클래스는 단 하나의 명확한 책임을 가집니다.
* **관리자 패턴:** 복잡한 로직은 각 '매니저' 클래스가 전담하여 처리합니다.
* **파일 분리 원칙:** 기능별로 파일을 적극적으로 분리하여 코드의 길이를 적절하게 유지합니다.
* **오컴의 면도날:** 무용한 효과나 중복된 행동, 과도한 수치 계산을 미리 걸러내어 가장 단순한 로직으로 운용합니다.

## 마이크로 스모크 테스트
`tests/microSmoke.test.js`에서는 게임의 핵심 로직을 짧게 검증하는 시나리오를 실행합니다. 새 콘텐츠가 추가될 때마다 이 테스트도 함께 업데이트하여 기본 동작을 계속 확인합니다.

## 데이터 무결성 테스트
`tests/dataIntegrity.test.js`에 각 데이터 구조를 검증하는 테스트를 모아 둡니다.
- 모든 스킬은 `manaCost` 속성을 포함해야 합니다.
- 무기 아이템에는 `damageDice`가 반드시 있어야 합니다.
- 스킬과 아이템의 `tags` 배열이 비어 있지 않은지 확인합니다.
새로운 데이터가 추가되면 이 파일에 검증 항목을 계속 추가하세요.

## 개발 방식
이 프로젝트는 하루 단위의 "Content-First / Smoke-Test-Later" 흐름으로 개발됩니다.

* 새 콘텐츠를 먼저 구현하고 다음 날 스모크 테스트를 통해 문제를 정리합니다.
* 새 콘텐츠가 추가될 때 누락된 연결고리나 오류는 챗GPT 코덱스가 자동으로 보강하며, 한 번 들어온 패치는 필터링해 중복을 방지합니다.
* 이미 구현된 구조에 대해 사용자가 패치를 요구해도 규칙에 따라 자동으로 무시될 수 있습니다.
* 코드 리뷰와 전체 테스트는 주기적으로 수행하여 시스템 안정성을 확보합니다.
* 새로운 패치에 해당하는 png 파일이 있을 경우 챗 지피티 코덱스가 센스있게 적용합니다.

## 엠바고 테스트 운영 지침

* **커다란 패치가 있을 때만** 엠바고 테스트를 실행합니다. 자잘한 패치에서는 생략하며, 무엇이 큰 패치인지는 챗GPT 코덱스가 임의로 판단합니다.
* "커다란 패치"라면 자동으로 엠바고 테스트 항목을 적용합니다.
* 테스트 중에는 체력이 일정 이하로 감소하면 힐 포션을 사용하도록 시나리오를 구성합니다.
* 추후 힐러 용병이 등장해 포션을 쓰지 못하더라도, 힐러가 회복을 마쳤다면 테스트 실패로 보지 않습니다.
* 엠바고 테스트를 실행할 때마다 챗GPT 코덱스가 해당 테스트의 특이사항을 `엠바고-리뷰.md`에 기록합니다.
* 새 패치를 적용하기 전에는 항상 `엠바고-리뷰.md`를 정독해 최신 메모를 확인합니다.
* 2025-06-19 리뷰에는 실제 플레이 관점의 개선점이 기록되어 있으니 전투 연출과 UX 개선에 참고하세요.


## Additional Documentation

For detailed gameplay instructions, see [GAMEPLAY_GUIDE.md](GAMEPLAY_GUIDE.md).


## 결함 주입 테스트
MBTI AI와 힐러 AI의 오류 처리 능력을 확인하는 시나리오가 `tests/faultInjection.test.js`에 있습니다. 버퍼/디버퍼 AI가 추가되면 동일한 파일에서 함께 관리합니다.
이 테스트들은 매 패치마다 돌릴 필요는 없으며, 엠바고 테스트를 실행할 때 같이 수행하는 것을 권장합니다.
자세한 지침은 [FAULT_INJECTION_GUIDE.md](FAULT_INJECTION_GUIDE.md)를 참고하세요.

